# Cloud Function для обработки длинных аудио-файлов

Данный модуль создает следующие ресурсы:

1. Бакет Object Storage
2. Функцию Cloud Function
3. Cron тригер для функции, который срабатывает каждые три минуты
4. Сервисную учетную запись с правами для работы с Object Storage, SpeechKit, Lockbox
5. Сервисную учетную запись для запуска функции Cloud Function
6. Статический ключ доступа для работы с Object Storage и API-ключ для работы со Speechkit
7. Секрет в Lockbox для безопасного хранения ключей, используемых функцией Cloud Function

По умолчанию, используются следующие переменные для имен директорий внутри бакета:
* `s3_prefix_input = "input"`
* `s3_prefix_log = "log"`
* `s3_prefix_out = "out"`

Также, используется аутентификация в провайдере Terraform через `key.json` файл. 
При необходимости, измените аутентификацию на токен.

Чтобы запустить данный модуль, создайте файл с переменными `private.auto.tfvars` и сохраните в него folder_id и cloud_id вашего облака и каталога в нем:
```
cloud_id  = "b1g3xxxxxx"
folder_id = "b1g7xxxxxx
```

После этого, можно установить модуль Terraform:
```
terraform init
terraform apply
```

Перед удалением, не забудьте очистить созданный бакет (иначе процесс удаления прервется):
```
terraform destroy
```